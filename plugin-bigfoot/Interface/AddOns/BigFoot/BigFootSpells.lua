 local BFS_d3a651bc7e8e1c712fd41cc5f72c50f8 = {}; local BFS_7ebb2a9c27af423e4bc91ae902cd9978 = {}; local BFS_ddc6e88fb7febf4ea866e1871f20538e = nil; BIGFOOT_SPELL_EVENT_NEW = "new spell"; local BFS_b6af85d9d649721a033600f97f74e9c4 = 10; local BFS_86d8ae6dd444aeab652311ae113f3b88 = 0; local BFS_186dec0f5e1d770cbcb4fa16bd12fbd9 = 1; local BFS_8ee0ebaf34b0a800fbbc2c900866c4f4 = "NOT READY"; local BFS_450db100a3de4b8647a5a780791f6c15 = {}; if (GetLocale() == "zhCN") then BIGFOOT_SPELL_RANK_MATCH_PATTERN = "等级 (%d+)"; BIGFOOT_SPELL_INSTANT_PATTERN = "<n>瞬发"; elseif (GetLocale() == "zhTW") then BIGFOOT_SPELL_RANK_MATCH_PATTERN = "等級 (%d+)"; BIGFOOT_SPELL_INSTANT_PATTERN = "<n>立即施法"; else BIGFOOT_SPELL_RANK_MATCH_PATTERN = "Rank (%d+)"; BIGFOOT_SPELL_INSTANT_PATTERN = "<n>Instant cast"; end local BFS_Eventer = BLibrary:CreateInstance("BEvent"); BFS_Eventer:Init{ name = "BigFoot", func = function() BFS_Eventer:RegisterEvent("LEARNED_SPELL_IN_TAB",BFS_3d3a115d8ba23ec9b6f17af3ba4b741d); BFS_Eventer:RegisterEvent("PLAYER_LOGIN"); end } function BFS_Eventer.PLAYER_LOGIN() BigFoot_DelayCall(BFS_f4c7fc1fa217c1077ef84a4b2968525c, 10); end function BFS_f4c7fc1fa217c1077ef84a4b2968525c() if (BFS_8ee0ebaf34b0a800fbbc2c900866c4f4 ~= "READY") then if (BFS_8ee0ebaf34b0a800fbbc2c900866c4f4 == "NOT READY") then BFS_2ccbc822085094d9c5f108bb270981bd(true); end BigFoot_DelayCall(BFS_f4c7fc1fa217c1077ef84a4b2968525c, 1); return; end BFS_d3a651bc7e8e1c712fd41cc5f72c50f8 = BFS_450db100a3de4b8647a5a780791f6c15; BFS_ddc6e88fb7febf4ea866e1871f20538e = 1; end function BFS_603da6ed64fe5fd452069d46dc42cffd(BFS_b48c6d810781a0aaca7a1daf572bf0a2, BFS_776cc2335c5e051bd62524696424f056) if (BFS_776cc2335c5e051bd62524696424f056 and BFS_776cc2335c5e051bd62524696424f056 ~= "") then return BFS_b48c6d810781a0aaca7a1daf572bf0a2 .. "(" ..BFS_776cc2335c5e051bd62524696424f056 .. ")"; else return BFS_b48c6d810781a0aaca7a1daf572bf0a2; end end function BFS_2ccbc822085094d9c5f108bb270981bd(BFS_497dda28c3f08fb51490d767b3e49704) local BFS_3522d18be5a461cbdb52c559141f4a9a = GetNumSpellTabs(); local BFS_8983c60d66c8593ec7165ea9dbedb584, BFS_9248008bbb6d0ee7ce13f6ee45680051, BFS_98b436aae97b9941de81152428c81208, BFS_602dceb5418dc9410df12b60b7a8437a; local BFS_2060166a845d5fa52a87e780440bcc90; local BFS_3f50417fb16be9b1078eb68d24fa9c26 = 0; if (BFS_497dda28c3f08fb51490d767b3e49704) then if (BFS_8ee0ebaf34b0a800fbbc2c900866c4f4 ~= "SCANING") then BFS_450db100a3de4b8647a5a780791f6c15 = {}; end BFS_8ee0ebaf34b0a800fbbc2c900866c4f4 = "SCANING"; else BFS_450db100a3de4b8647a5a780791f6c15 = {}; end for BFS_e914904fab9d05d3f54d52bfc31a0f3f = 1, MAX_SKILLLINE_TABS do if (BFS_e914904fab9d05d3f54d52bfc31a0f3f <= BFS_3522d18be5a461cbdb52c559141f4a9a) then BFS_b4d3314490a868cf61f5fbd057900b0b, BFS_9248008bbb6d0ee7ce13f6ee45680051, BFS_98b436aae97b9941de81152428c81208, BFS_602dceb5418dc9410df12b60b7a8437a = GetSpellTabInfo(BFS_e914904fab9d05d3f54d52bfc31a0f3f); for BFS_5e57ab95c762a48d9a126b104db1056f = 1, BFS_602dceb5418dc9410df12b60b7a8437a do BFS_3f50417fb16be9b1078eb68d24fa9c26 = BFS_3f50417fb16be9b1078eb68d24fa9c26 + 1; if (not BFS_497dda28c3f08fb51490d767b3e49704 or BFS_3f50417fb16be9b1078eb68d24fa9c26 >= BFS_186dec0f5e1d770cbcb4fa16bd12fbd9) then if (BFS_497dda28c3f08fb51490d767b3e49704) then BFS_86d8ae6dd444aeab652311ae113f3b88 = BFS_86d8ae6dd444aeab652311ae113f3b88 + 1; if (BFS_86d8ae6dd444aeab652311ae113f3b88 > BFS_b6af85d9d649721a033600f97f74e9c4) then BFS_86d8ae6dd444aeab652311ae113f3b88 = 0; BigFoot_DelayCall(BFS_2ccbc822085094d9c5f108bb270981bd, 1, BFS_497dda28c3f08fb51490d767b3e49704); return; end BFS_186dec0f5e1d770cbcb4fa16bd12fbd9 = BFS_186dec0f5e1d770cbcb4fa16bd12fbd9 + 1; end local BFS_9248008bbb6d0ee7ce13f6ee45680051 = GetSpellTexture(BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f, BOOKTYPE_SPELL); local BFS_caa997efdeb36851b2f828f934939927, BFS_776cc2335c5e051bd62524696424f056 = GetSpellInfo(BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f, BOOKTYPE_SPELL); local BFS_575f486b35a698c76cedbb99b4c24d8e = IsPassiveSpell(BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f, BOOKTYPE_SPELL); local BFS_a737304a0a12acb060c26b9da12f857c, BFS_876ae3817655938dba8b508a2da65e97, BFS_010248dc5489610d984cca761c0a905e = GetSpellCooldown(BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f, BOOKTYPE_SPELL); BigFoot_Tooltip_Init(); if (GetLocale() =="zhCN") then BigFootTooltip:SetSpell(BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f, BOOKTYPE_SPELL) else BigFootTooltip:SetSpellBookItem(BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f, BOOKTYPE_SPELL) end local BFS_e6955c64cf39bdb23dc86de1a9ec2117 = BigFoot_Tooltip_GetText(nil, ""); BigFootTooltip:Hide(); local BFS_8d0febf2348ea712b2b375ae95601d5f = BFS_603da6ed64fe5fd452069d46dc42cffd(BFS_caa997efdeb36851b2f828f934939927, BFS_776cc2335c5e051bd62524696424f056); BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f] = {}; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["name"] = BFS_caa997efdeb36851b2f828f934939927; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["rank"] = BFS_776cc2335c5e051bd62524696424f056; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["category"] = BFS_b4d3314490a868cf61f5fbd057900b0b; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["texture"] = BFS_9248008bbb6d0ee7ce13f6ee45680051; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["passive"] = BFS_575f486b35a698c76cedbb99b4c24d8e; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["id"] = BFS_98b436aae97b9941de81152428c81208 + BFS_5e57ab95c762a48d9a126b104db1056f; BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["type"] = BOOKTYPE_SPELL; if (string.find(BFS_e6955c64cf39bdb23dc86de1a9ec2117, BIGFOOT_SPELL_INSTANT_PATTERN)) then BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["instant"] = 1; end BFS_450db100a3de4b8647a5a780791f6c15[BFS_8d0febf2348ea712b2b375ae95601d5f]["description"] = BFS_e6955c64cf39bdb23dc86de1a9ec2117; end end end end if (BFS_497dda28c3f08fb51490d767b3e49704) then BFS_186dec0f5e1d770cbcb4fa16bd12fbd9 = 1; BFS_86d8ae6dd444aeab652311ae113f3b88 = 0; BFS_8ee0ebaf34b0a800fbbc2c900866c4f4 = "READY"; end end function BFS_3d3a115d8ba23ec9b6f17af3ba4b741d() if (not BFS_ddc6e88fb7febf4ea866e1871f20538e) then return; end BFS_2ccbc822085094d9c5f108bb270981bd(); local BFS_aa877706d5c90299af9a0d1327eb0bec = {}; local BFS_413bf9c15ce77baa8ebf1cda4cbf4887, BFS_2361bab8b48b1041ad740bb561b21aee; for BFS_413bf9c15ce77baa8ebf1cda4cbf4887, BFS_2361bab8b48b1041ad740bb561b21aee in pairs(BFS_450db100a3de4b8647a5a780791f6c15) do if (not BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_413bf9c15ce77baa8ebf1cda4cbf4887]) then BFS_aa877706d5c90299af9a0d1327eb0bec[BFS_413bf9c15ce77baa8ebf1cda4cbf4887] = BFS_2361bab8b48b1041ad740bb561b21aee; end end if (BFS_7ebb2a9c27af423e4bc91ae902cd9978[BIGFOOT_SPELL_EVENT_NEW]) then for BFS_413bf9c15ce77baa8ebf1cda4cbf4887, BFS_2361bab8b48b1041ad740bb561b21aee in pairs(BFS_aa877706d5c90299af9a0d1327eb0bec) do for BFS_08b8d54960760e15addd09345c991032, BFS_c31af5fd9021206e921af3d99e5a90af in pairs(BFS_7ebb2a9c27af423e4bc91ae902cd9978[BIGFOOT_SPELL_EVENT_NEW]) do BFS_c31af5fd9021206e921af3d99e5a90af(BFS_2361bab8b48b1041ad740bb561b21aee["id"], BFS_2361bab8b48b1041ad740bb561b21aee["name"], BFS_2361bab8b48b1041ad740bb561b21aee["rank"], BFS_2361bab8b48b1041ad740bb561b21aee["category"], BFS_2361bab8b48b1041ad740bb561b21aee["type"], BFS_2361bab8b48b1041ad740bb561b21aee["texture"], BFS_2361bab8b48b1041ad740bb561b21aee["description"], BFS_2361bab8b48b1041ad740bb561b21aee["passive"], BFS_2361bab8b48b1041ad740bb561b21aee["instant"]); end end end BFS_d3a651bc7e8e1c712fd41cc5f72c50f8 = BFS_450db100a3de4b8647a5a780791f6c15; end function BigFootSpells_RegisterNewSpellSink(BFS_d0708241b607c9a9dd1953c812fadfb7, BFS_c31af5fd9021206e921af3d99e5a90af) local BFS_00878024a7892c3d77ff1d47e8c0abae = getglobal(BFS_c31af5fd9021206e921af3d99e5a90af); if (type(BFS_00878024a7892c3d77ff1d47e8c0abae) == "function") then if ( not BFS_7ebb2a9c27af423e4bc91ae902cd9978[BFS_d0708241b607c9a9dd1953c812fadfb7]) then BFS_7ebb2a9c27af423e4bc91ae902cd9978[BFS_d0708241b607c9a9dd1953c812fadfb7] = {}; end BFS_7ebb2a9c27af423e4bc91ae902cd9978[BFS_d0708241b607c9a9dd1953c812fadfb7][BFS_c31af5fd9021206e921af3d99e5a90af] = BFS_00878024a7892c3d77ff1d47e8c0abae; end end function BigFootSpells_UnregisterNewSpellSink(BFS_d0708241b607c9a9dd1953c812fadfb7, BFS_c31af5fd9021206e921af3d99e5a90af) if (BFS_7ebb2a9c27af423e4bc91ae902cd9978[BFS_d0708241b607c9a9dd1953c812fadfb7] and BFS_7ebb2a9c27af423e4bc91ae902cd9978[BFS_d0708241b607c9a9dd1953c812fadfb7][BFS_c31af5fd9021206e921af3d99e5a90af]) then BFS_7ebb2a9c27af423e4bc91ae902cd9978[BFS_d0708241b607c9a9dd1953c812fadfb7][BFS_c31af5fd9021206e921af3d99e5a90af] = nil; end end function BigFootSpell_GetSpellInfo(BFS_8983c60d66c8593ec7165ea9dbedb584, BFS_776cc2335c5e051bd62524696424f056) if (not BFS_ddc6e88fb7febf4ea866e1871f20538e) then return; end if (not BFS_776cc2335c5e051bd62524696424f056) then BFS_776cc2335c5e051bd62524696424f056 = BigFootSpell_GetSpellMaxRank(BFS_8983c60d66c8593ec7165ea9dbedb584); end local BFS_8d0febf2348ea712b2b375ae95601d5f = BFS_603da6ed64fe5fd452069d46dc42cffd(BFS_8983c60d66c8593ec7165ea9dbedb584, BFS_776cc2335c5e051bd62524696424f056); if (BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]) then return BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["id"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["name"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["rank"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["category"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["type"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["texture"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["description"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["passive"], BFS_d3a651bc7e8e1c712fd41cc5f72c50f8[BFS_8d0febf2348ea712b2b375ae95601d5f]["instant"]; end end function BigFootSpell_GetSpellMaxRank(BFS_8983c60d66c8593ec7165ea9dbedb584) local BFS_18eb80299bd465265cdea475ef2f788b = 0; local BFS_7055060047c4e75028a795318cd9176e; if (not BFS_ddc6e88fb7febf4ea866e1871f20538e) then return; end local BFS_413bf9c15ce77baa8ebf1cda4cbf4887, BFS_2361bab8b48b1041ad740bb561b21aee; for BFS_413bf9c15ce77baa8ebf1cda4cbf4887, BFS_2361bab8b48b1041ad740bb561b21aee in pairs(BFS_d3a651bc7e8e1c712fd41cc5f72c50f8) do if (BFS_8983c60d66c8593ec7165ea9dbedb584 == BFS_2361bab8b48b1041ad740bb561b21aee["name"]) then if (BFS_2361bab8b48b1041ad740bb561b21aee["rank"]) then local BFS_6e4d0db7491d6883f86de390d20dbe5b, BFS_a2f3972c23a0aa3bd7fb0e9823d918f2, BFS_776cc2335c5e051bd62524696424f056 = string.find(BFS_2361bab8b48b1041ad740bb561b21aee["rank"], BIGFOOT_SPELL_RANK_MATCH_PATTERN); if (BFS_776cc2335c5e051bd62524696424f056) then BFS_776cc2335c5e051bd62524696424f056 = tonumber(BFS_776cc2335c5e051bd62524696424f056); if (BFS_776cc2335c5e051bd62524696424f056 > BFS_18eb80299bd465265cdea475ef2f788b) then BFS_7055060047c4e75028a795318cd9176e = BFS_2361bab8b48b1041ad740bb561b21aee["rank"]; BFS_18eb80299bd465265cdea475ef2f788b = BFS_776cc2335c5e051bd62524696424f056; end else if (BFS_18eb80299bd465265cdea475ef2f788b == 0) then BFS_7055060047c4e75028a795318cd9176e = BFS_2361bab8b48b1041ad740bb561b21aee["rank"]; end end else if (BFS_18eb80299bd465265cdea475ef2f788b == 0) then BFS_7055060047c4e75028a795318cd9176e = BFS_2361bab8b48b1041ad740bb561b21aee["rank"]; end end end end return BFS_7055060047c4e75028a795318cd9176e; end
