 zFeeder = {Link = nil, Texture = nil, Count = nil, Item = "",} if (GetLocale() == "zhCN") then ZFEEDER_MOVE_TOOLTIP = "按住Shift可拖动框体\nShift+右键重置鼠标位置"; elseif (GetLocale() == "zhTW") then ZFEEDER_MOVE_TOOLTIP = "按住Shift可拖動框體\nShift+右鍵重置滑鼠位置"; else ZFEEDER_MOVE_TOOLTIP = "Hold shift to move frame\nShift + Right click to reset position"; end local BigFootGather_1e21bf09480ac08a0f6dbe8c4d7f00d1 = false; local BigFootGather_1ff55ee7265fb9292cb729344dc444e2 = false; local BigFootGather_e4ccb3198f7dd446a67b1046755e6e9f = false; local BigFootGather_b172c60ff6ace01e6d49d33e36cff35b = nil; local BigFootGather_4d37d9369ebec645b5b2b3afb43b8e71 = false; local BigFootGather_45a9ff9372ccff7f24898550422fa956 = 2; local BigFootGather_785cc825ca0bd563270631f3741d3871 = { [PET_HAPPINESS1] = 2, [PET_HAPPINESS2] = 3 }; function BigFootGather_c37fa2c21f10036a9cf3c0e9c8b3d4cd(BigFootGather_15ad1e501e228eb80be1cc7800ab967d) if (BigFootGather_15ad1e501e228eb80be1cc7800ab967d) then for id in string.gmatch(BigFootGather_15ad1e501e228eb80be1cc7800ab967d, "|%x+|Hitem:(%d+):") do return tonumber(id) end end end local function zHasFeedEffect() local i = 1; local BigFootGather_8983c60d66c8593ec7165ea9dbedb584, BigFootGather_776cc2335c5e051bd62524696424f056, BigFootGather_9248008bbb6d0ee7ce13f6ee45680051, BigFootGather_3f50417fb16be9b1078eb68d24fa9c26, BigFootGather_2cd061ac659f3ca840ca0ce293a3e67b, BigFootGather_876ae3817655938dba8b508a2da65e97, BigFootGather_deadf5b4ff14a89508941e3b53b70068 = UnitAura("pet", i); while (BigFootGather_9248008bbb6d0ee7ce13f6ee45680051 and BigFootGather_876ae3817655938dba8b508a2da65e97 and BigFootGather_deadf5b4ff14a89508941e3b53b70068 and BigFootGather_876ae3817655938dba8b508a2da65e97 > 0) do local BigFootGather_5e57c2750895232501d674704d8ef219 = BigFootGather_deadf5b4ff14a89508941e3b53b70068 - GetTime(); if ( string.find(BigFootGather_9248008bbb6d0ee7ce13f6ee45680051, "Ability_Hunter_BeastTraining") ) then return true, BigFootGather_876ae3817655938dba8b508a2da65e97, BigFootGather_5e57c2750895232501d674704d8ef219; end i = i + 1; BigFootGather_8983c60d66c8593ec7165ea9dbedb584, BigFootGather_776cc2335c5e051bd62524696424f056, BigFootGather_9248008bbb6d0ee7ce13f6ee45680051, BigFootGather_3f50417fb16be9b1078eb68d24fa9c26, BigFootGather_2cd061ac659f3ca840ca0ce293a3e67b, BigFootGather_876ae3817655938dba8b508a2da65e97, BigFootGather_deadf5b4ff14a89508941e3b53b70068 = UnitAura("pet", i); end return nil end local function BigFootGather_565a53d981676acfbbc7e690c3c696b6(BigFootGather_bd8865dc9495a8195a44b47071cae418) if (not BigFootGather_bd8865dc9495a8195a44b47071cae418) then return nil, nil; end local BigFootGather_a838a95650b0a139c5f3b3430992d9b7 = BigFootGather_c37fa2c21f10036a9cf3c0e9c8b3d4cd(BigFootGather_bd8865dc9495a8195a44b47071cae418); for BigFootGather_a4e435952d7906b01358c3f8f9ff67e8 = 0, NUM_BAG_FRAMES do for BigFootGather_f5cb07751fccdf339be4192634943a73 = 1, GetContainerNumSlots(BigFootGather_a4e435952d7906b01358c3f8f9ff67e8) do local BigFootGather_15ad1e501e228eb80be1cc7800ab967d = GetContainerItemLink(BigFootGather_a4e435952d7906b01358c3f8f9ff67e8, BigFootGather_f5cb07751fccdf339be4192634943a73); if (BigFootGather_15ad1e501e228eb80be1cc7800ab967d) then local BigFootGather_000a1574634897f1ffd22ad235c8f27a = BigFootGather_c37fa2c21f10036a9cf3c0e9c8b3d4cd(BigFootGather_15ad1e501e228eb80be1cc7800ab967d); if (BigFootGather_000a1574634897f1ffd22ad235c8f27a and BigFootGather_a838a95650b0a139c5f3b3430992d9b7 and BigFootGather_000a1574634897f1ffd22ad235c8f27a == BigFootGather_a838a95650b0a139c5f3b3430992d9b7) then return BigFootGather_a4e435952d7906b01358c3f8f9ff67e8, BigFootGather_f5cb07751fccdf339be4192634943a73; end end end end return nil, nil; end local function BigFootGather_0617fde45415718d40730392fe9df871(BigFootGather_99f3cf2c6f1fdfadb0fd4ab6e0843bf5) if(zFeeder.Texture) then SetItemButtonTexture(BigFootGather_99f3cf2c6f1fdfadb0fd4ab6e0843bf5, zFeeder.Texture); end end local function BigFootGather_e03e7e15ec7eaf494d978b18608f6a58(BigFootGather_99f3cf2c6f1fdfadb0fd4ab6e0843bf5) if (zFeeder.Link) then zFeeder.Count = GetItemCount(zFeeder.Link); SetItemButtonCount(BigFootGather_99f3cf2c6f1fdfadb0fd4ab6e0843bf5, zFeeder.Count); if(zFeeder.Count and zFeeder.Count == 0) then zFeederButtonIconTexture:SetVertexColor(1.0, 0.1, 0.1); else zFeederButtonIconTexture:SetVertexColor(1.0, 1.0, 1.0); end end end local BigFootGather_732786cdcc6894b7321edbb2f0bfe64d = BLibrary("BEvent"); BigFootGather_732786cdcc6894b7321edbb2f0bfe64d:Init{ name = "HunterAssist", func = function() BigFootGather_0617fde45415718d40730392fe9df871(getglobal("zFeederButton")); BigFootGather_e03e7e15ec7eaf494d978b18608f6a58(getglobal("zFeederButton")); getglobal("zFeederButton"):SetAttribute("unit", "pet"); getglobal("zFeederButton"):SetAttribute("type", "target"); end }; function ZFeed_Toggle(BigFootGather_43975aa4b29e368c1d658b08e332e857) if (BigFootGather_43975aa4b29e368c1d658b08e332e857) then BigFootGather_732786cdcc6894b7321edbb2f0bfe64d:RegisterEvent("PLAYER_REGEN_ENABLED"); BigFootGather_732786cdcc6894b7321edbb2f0bfe64d:RegisterEvent("BAG_UPDATE"); if (not BigFootGather_4d37d9369ebec645b5b2b3afb43b8e71) then hooksecurefunc("PetFrame_SetHappiness", BigFootGather_a354deae0f958c476ec19ec10fd22f10); end getglobal("zFeederButton"):Show(); else BigFootGather_732786cdcc6894b7321edbb2f0bfe64d:UnregisterEvent("PLAYER_REGEN_ENABLED"); BigFootGather_732786cdcc6894b7321edbb2f0bfe64d:UnregisterEvent("BAG_UPDATE"); getglobal("zFeederButton"):Hide(); end end function ZFeed_CHappiness(happiness) local happiness = tostring(happiness); BigFootGather_45a9ff9372ccff7f24898550422fa956 = BigFootGather_785cc825ca0bd563270631f3741d3871[happiness] or 2; end function zfOnLoad(self) self:RegisterForDrag("LeftButton", "RightButton"); self:RegisterForClicks("LeftButtonUp", "RightButtonUp"); self.time = 0; end function BigFootGather_732786cdcc6894b7321edbb2f0bfe64d.PLAYER_REGEN_ENABLED() end function BigFootGather_732786cdcc6894b7321edbb2f0bfe64d.BAG_UPDATE() BigFootGather_e03e7e15ec7eaf494d978b18608f6a58(getglobal("zFeederButton")); end function zfOnEnter(self) GameTooltip:SetOwner(self, "ANCHOR_RIGHT"); if (zFeeder.Link) then GameTooltip:SetText(ZF_BUTTON_TITLE); GameTooltip:AddDoubleLine(ZF_FOODNAME, zFeeder.Link, 1, 1, 1, 1,1,1); GameTooltip:AddDoubleLine(ZF_FOODQUANTITY, zFeeder.Count, 1, 1, 1, 1,1,1); GameTooltip:AddLine(ZFEEDER_MOVE_TOOLTIP, 0.5, 0.5, 0.5, 1); else GameTooltip:AddLine(ZF_NO_FOOD, 1, 1, 1); GameTooltip:AddLine(ZFEEDER_MOVE_TOOLTIP, 0.5, 0.5, 0.5, 1); end GameTooltip:Show(); end function zfOnLeave(self) GameTooltip:Hide(); end function zfPreClick(self, button) if (InCombatLockdown()) then return; end if (CursorHasItem()) then local _, BigFootGather_1f194f793e9150819d886c66d5bc23b5, BigFootGather_e498578b78aa0db9c45f30f87d63debc = GetCursorInfo(); local BigFootGather_a3cb6a88d849aa772e8e5e65e8cb49e2 = select(10, GetItemInfo(BigFootGather_e498578b78aa0db9c45f30f87d63debc)); if (BigFootGather_1f194f793e9150819d886c66d5bc23b5 and BigFootGather_e498578b78aa0db9c45f30f87d63debc and BigFootGather_a3cb6a88d849aa772e8e5e65e8cb49e2) then zFeeder.Item = BigFootGather_1f194f793e9150819d886c66d5bc23b5; zFeeder.Link = BigFootGather_e498578b78aa0db9c45f30f87d63debc; zFeeder.Texture = BigFootGather_a3cb6a88d849aa772e8e5e65e8cb49e2; BigFootGather_0617fde45415718d40730392fe9df871(self); end GameTooltip:Hide(); ClearCursor(); BigFootGather_e03e7e15ec7eaf494d978b18608f6a58(self); else if (IsShiftKeyDown() and arg1 == "RightButton") then zFeederButton:ClearAllPoints(); zFeederButton:SetPoint("LEFT", "PetFrameHappiness", "RIGHT", 4, 0); elseif (zFeeder.Link) then local BigFootGather_a4e435952d7906b01358c3f8f9ff67e8, BigFootGather_f5cb07751fccdf339be4192634943a73 = BigFootGather_565a53d981676acfbbc7e690c3c696b6(zFeeder.Link); local hasEffect = zHasFeedEffect(); if (BigFootGather_a4e435952d7906b01358c3f8f9ff67e8 and BigFootGather_f5cb07751fccdf339be4192634943a73 and not hasEffect) then PickupContainerItem(BigFootGather_a4e435952d7906b01358c3f8f9ff67e8, BigFootGather_f5cb07751fccdf339be4192634943a73); end end end end function zfOnDragStart(self) GameTooltip:Hide(); if (IsShiftKeyDown()) then self:StartMoving(); BigFootGather_b172c60ff6ace01e6d49d33e36cff35b = true; return; end zFeeder.Link = nil; zFeeder.Count = nil; zFeeder.Texture = nil; zFeeder.Item = ""; SetItemButtonCount(self, 0); SetItemButtonTexture(self, nil); end function zfOnDragStop(self) if (BigFootGather_b172c60ff6ace01e6d49d33e36cff35b) then self:StopMovingOrSizing(); end end function zfOnUpdate(self, elapsed) self.time = self.time + elapsed; if (self.time > 0.3) then local hasEffect, duration, timeleft = zHasFeedEffect(); if (hasEffect and duration) then PetFrameManaBar:SetStatusBarColor(0.0, 1.0, 1.0); PetFrameManaBar:SetMinMaxValues(0, duration); PetFrameManaBar:SetValue(duration - math.floor(timeleft)); PetFrameManaBar:UnregisterEvent("UNIT_HAPPINESS"); self.feeding = true; elseif (self.feeding) then PetFrameManaBar:RegisterEvent("UNIT_HAPPINESS"); UnitFrameManaBar_Update(PetFrameManaBar:GetParent()); self.feeding = false; end self.time = 0; end end function BigFootGather_a354deae0f958c476ec19ec10fd22f10(...) local BigFootGather_658c7527ccc627d3d612469dbad61e47 = GetPetHappiness(); if (BigFootGather_658c7527ccc627d3d612469dbad61e47 and BigFootGather_658c7527ccc627d3d612469dbad61e47 < BigFootGather_45a9ff9372ccff7f24898550422fa956) then if ( not BigFootGather_e4ccb3198f7dd446a67b1046755e6e9f or (GetTime() - BigFootGather_e4ccb3198f7dd446a67b1046755e6e9f) > 1000 ) then BigFootGather_e4ccb3198f7dd446a67b1046755e6e9f = GetTime(); UIErrorsFrame:AddMessage(ZF_HUNGER, 1.0, 1.0, 0.0, 1.0, UIERRORS_HOLD_TIME); end else end BigFootGather_1ff55ee7265fb9292cb729344dc444e2 = false; end
